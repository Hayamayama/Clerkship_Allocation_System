# ðŸ¥ é†«é™¢è¦‹ç¿’å¿—é¡˜è‡ªå‹•åˆ†é…ç³»çµ± (Clerkship Allocation System)

é€™æ˜¯ä¸€å€‹åŸºæ–¼ Google Workspace (Sheets, Forms, Apps Script) çš„è‡ªå‹•åŒ–è…³æœ¬ï¼Œæ—¨åœ¨å…¬å¹³ã€é«˜æ•ˆåœ°ç‚ºåŒå­¸åˆ†é…è‡¨åºŠè¦‹ç¿’çš„é†«é™¢èˆ‡æ™‚æ®µã€‚

---

## ðŸš€ å°ˆæ¡ˆç‰¹è‰²

* **å®Œå…¨è‡ªå‹•åŒ–**ï¼šåªéœ€ä¸€éµåŸ·è¡Œï¼Œå³å¯åœ¨æ•¸ç§’å…§å®Œæˆå…¨ç­å­¸ç”Ÿçš„åˆ†ç™¼ã€‚
* **çµ•å°å…¬å¹³**ï¼šåš´æ ¼éµå®ˆæŠ½ç±¤çš„é¸å¡«é †åºï¼Œç¢ºä¿æµç¨‹é€æ˜Žã€ç„¡çˆ­è­°ã€‚
* **é«˜æ“´å±•æ€§**ï¼šå¯è¼•æ˜“é€éŽä¿®æ”¹ Google Sheet ä¾†å¢žæ¸›é†«é™¢åé¡ã€èª¿æ•´å­¸ç”Ÿé †åºæˆ–æŒ‡æ´¾è€å¸«ã€‚
* **é›¶æˆæœ¬**ï¼šå®Œå…¨åˆ©ç”¨å…è²»çš„ Google å·¥å…·å¯¦ç¾ï¼Œç„¡éœ€é¡å¤–è²»ç”¨ã€‚

---

## ðŸ”§ ç³»çµ±æž¶æ§‹ (System Architecture)

æœ¬å°ˆæ¡ˆåˆ©ç”¨ Google ç”Ÿæ…‹ç³»ï¼Œå°‡è³‡æ–™æ”¶é›†ã€è™•ç†èˆ‡çµæžœå‘ˆç¾ä¸²è¯èµ·ä¾†ï¼Œå½¢æˆä¸€å€‹å®Œæ•´çš„è‡ªå‹•åŒ–æµç¨‹ã€‚

**æµç¨‹åœ–:**
`Google Form (è³‡æ–™æ”¶é›†)` -> `Google Sheet (è³‡æ–™å„²å­˜)` -> `Google Apps Script (æ ¸å¿ƒé‚è¼¯)` -> `Google Sheet (çµæžœè¼¸å‡º)`

1.  **è³‡æ–™æ”¶é›†å±¤ (Data Collection Layer)**
    * **å·¥å…·**ï¼š**Google è¡¨å–® (Google Forms)**
    * **èªªæ˜Ž**ï¼šå»ºç«‹ä¸€ä»½æ¨™æº–åŒ–çš„ç·šä¸Šè¡¨å–®ï¼Œä¾›å­¸ç”Ÿå¡«å¯«å…¶å­¸è™Ÿã€å§“ååŠäº”å€‹å¯¦ç¿’å¿—é¡˜ã€‚åˆ©ç”¨ä¸‹æ‹‰å¼é¸å–®åŠŸèƒ½ï¼Œç¢ºä¿è³‡æ–™æ ¼å¼çš„çµ±ä¸€æ€§ï¼Œé¿å…äººå·¥è¼¸å…¥éŒ¯èª¤ã€‚

2.  **è³‡æ–™å„²å­˜å±¤ (Data Storage Layer)**
    * **å·¥å…·**ï¼š**Google è©¦ç®—è¡¨ (Google Sheets)**
    * **èªªæ˜Ž**ï¼šæ‰€æœ‰è¡¨å–®çš„å›žæ‡‰æœƒè‡ªå‹•å½™æ•´æ–¼æ­¤ã€‚å°ˆæ¡ˆåŒ…å«å››å€‹æ ¸å¿ƒå·¥ä½œè¡¨ï¼š
        * `è¡¨å–®å›žæ‡‰`ï¼šåŽŸå§‹è¡¨å–®å›žæ‡‰ã€‚
        * `é¸å¡«é †åºè¡¨`ï¼šå„²å­˜æŠ½ç±¤æ±ºå®šçš„å­¸ç”Ÿé¸å¡«é †åº (é—œéµæŽ’åºä¾æ“š)ã€‚
        * `å¯¦ç¿’åé¡è¡¨`ï¼šå®šç¾©æ‰€æœ‰å¯¦ç¿’æ™‚æ®µçš„ä»£ç¢¼ã€é–‹æ”¾åé¡åŠè² è²¬è€å¸«ã€‚
        * `æœ€çµ‚åˆ†ç™¼çµæžœ`ï¼šç”±ç¨‹å¼è‡ªå‹•ç”¢ç”Ÿçš„æœ€çµ‚åˆ†é…çµæžœã€‚

3.  **æ ¸å¿ƒé‚è¼¯å±¤ (Business Logic Layer)**
    * **å·¥å…·**ï¼š**Google Apps Script**
    * **èªªæ˜Ž**ï¼šé€™æ˜¯æ•´å€‹ç³»çµ±çš„å¤§è…¦ã€‚ç¨‹å¼ç¢¼ ( `main.gs` ) åŸ·è¡Œä»¥ä¸‹æ ¸å¿ƒæ¼”ç®—æ³•ï¼š
        * **è®€å–**ï¼šè®€å–ä¸Šè¿°ä¸‰å€‹è³‡æ–™å·¥ä½œè¡¨çš„æ•¸æ“šã€‚
        * **æŽ’åº**ï¼šæ ¹æ“š `é¸å¡«é †åºè¡¨`ï¼Œå°æ‰€æœ‰å­¸ç”Ÿé€²è¡Œå„ªå…ˆç´šæŽ’åºã€‚
        * **è¿­ä»£åˆ†é…**ï¼šå¾žæŽ’åºç¬¬ä¸€çš„å­¸ç”Ÿé–‹å§‹ï¼Œä¾åºæª¢æŸ¥å…¶å¿—é¡˜ã€‚
        * **åé¡æª¢æŸ¥**ï¼šåˆ¤æ–·å­¸ç”Ÿçš„å¿—é¡˜æ˜¯å¦é‚„æœ‰å‰©é¤˜åé¡ã€‚è‹¥æœ‰ï¼Œå‰‡åˆ†é…æˆåŠŸï¼›è‹¥ç„¡ï¼Œå‰‡æª¢æŸ¥ä¸‹ä¸€å€‹å¿—é¡˜ã€‚
        * **å¯«å…¥**ï¼šå°‡æ‰€æœ‰å­¸ç”Ÿçš„åˆ†é…çµæžœï¼Œæ‰¹æ¬¡å¯«å…¥ `æœ€çµ‚åˆ†ç™¼çµæžœ` å·¥ä½œè¡¨ã€‚

4.  **çµæžœå‘ˆç¾å±¤ (Presentation Layer)**
    * **å·¥å…·**ï¼š**Google è©¦ç®—è¡¨ (Google Sheets)**
    * **èªªæ˜Ž**ï¼š`æœ€çµ‚åˆ†ç™¼çµæžœ` å·¥ä½œè¡¨æ¸…æ™°åœ°å±•ç¤ºäº†æ¯ä½å­¸ç”Ÿçš„å­¸è™Ÿã€å§“ååŠæœ€çµ‚åˆ†é…åˆ°çš„å¯¦ç¿’å¿—é¡˜ä»£ç¢¼ï¼Œå¯ç›´æŽ¥åŒ¯å‡ºæˆ–åˆ†äº«ã€‚

---

## ðŸ› ï¸ ã€é‡è¦ã€‘å‰ç½®è¨­å®šèˆ‡æ“ä½œæ‰‹å†Š

è«‹åš´æ ¼ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿé€²è¡Œè¨­å®šï¼Œä»¥ç¢ºä¿ç³»çµ±èƒ½æ­£ç¢ºé‹ä½œã€‚

### **ç¬¬ä¸€æ­¥ï¼šå»ºç«‹èˆ‡æº–å‚™ Google Sheet**

1.  **å»ºç«‹ Google Sheet**ï¼š
    * åœ¨ä½ çš„ Google é›²ç«¯ç¡¬ç¢Ÿå»ºç«‹ä¸€ä»½æ–°çš„ Google è©¦ç®—è¡¨ï¼Œå¯å‘½åç‚ºã€Œå¯¦ç¿’å¿—é¡˜åˆ†é…ç¸½è¡¨ã€ã€‚
    * åœ¨é€™ä»½è©¦ç®—è¡¨ä¸­ï¼Œå»ºç«‹**å››å€‹å·¥ä½œè¡¨åˆ†é **ï¼Œä¸¦ç¢ºä¿åç¨±èˆ‡ä¸‹æ–¹å®Œå…¨ä¸€è‡´ï¼š
        1.  `è¡¨å–®å›žæ‡‰`
        2.  `é¸å¡«é †åºè¡¨`
        3.  `å¯¦ç¿’åé¡è¡¨`
        4.  `æœ€çµ‚åˆ†ç™¼çµæžœ`

2.  **æº–å‚™ `å¯¦ç¿’åé¡è¡¨`**ï¼š
    * é€™æ˜¯æœ€é—œéµçš„è³‡æ–™è¡¨ï¼Œå®šç¾©äº†æ‰€æœ‰å¯é¸çš„å¿—é¡˜ã€‚
    * è«‹å»ºç«‹ä¸‰å€‹æ¬„ä½ï¼š`å¿—é¡˜ä»£ç¢¼`ã€`é–‹æ”¾åé¡`
    * **å¿—é¡˜ä»£ç¢¼**ï¼šç‚ºæ¯å€‹ã€Œæ©Ÿæ§‹-æ™‚æ®µã€çµ„åˆè¨­å®šä¸€å€‹**ç¨ä¸€ç„¡äºŒ**çš„ä»£ç¢¼ (ä¾‹å¦‚ `H01`, `V01`)ã€‚
    * **é–‹æ”¾åé¡**ï¼šå¡«å¯«è©²æ™‚æ®µå¯æŽ¥å—çš„å­¸ç”Ÿäººæ•¸ (ä¾‹å¦‚ `1` æˆ– `2`)ã€‚

    **ç¯„ä¾‹ï¼š**
    | å¿—é¡˜ä»£ç¢¼ | é–‹æ”¾åé¡ |
    | :--- | :--- | 
    | H01 | 2 | 
    | H02 | 2 | 
    | V01 | 1 | 
    | ... | ... | 

3.  **æº–å‚™ `é¸å¡«é †åºè¡¨`**ï¼š
    * æ ¹æ“šæŠ½ç±¤çµæžœï¼Œå»ºç«‹å­¸ç”Ÿçš„é¸å¡«é †åºã€‚
    * è«‹å»ºç«‹ä¸‰å€‹æ¬„ä½ï¼š`é †åº`ã€`å­¸è™Ÿ`ã€`å§“å`ã€‚
    * **é‡è¦**ï¼šæ­¤è™•çš„**å­¸è™Ÿ**å¿…é ˆèˆ‡å­¸ç”Ÿåœ¨ Google è¡¨å–®ä¸­å¡«å¯«çš„å­¸è™Ÿå®Œå…¨ä¸€è‡´ï¼Œé€™æ˜¯ç³»çµ±é…å°çš„å”¯ä¸€ä¾æ“šã€‚

    **ç¯„ä¾‹ï¼š**
    | é †åº | å­¸è™Ÿ | å§“å |
    | :--- | :--- | :--- |
    | 1 | S01 | çŽ‹å¤§æ˜Ž |
    | 2 | S02 | é™³å°è¯ |
    | ... | ... | ... |

### **ç¬¬äºŒæ­¥ï¼šè¨­è¨ˆèˆ‡ç™¼å¸ƒ Google Form**

1.  **å»ºç«‹ Google Form**ï¼š
    * å»ºç«‹ä¸€ä»½æ–°çš„ Google è¡¨å–®ã€‚
    * é»žæ“Šã€Œè¨­å®šã€ï¼Œåœ¨ã€Œå›žæ‡‰ã€å€å¡Šï¼Œé–‹å•Ÿã€Œ**é™åˆ¶æ¯ä½ä½¿ç”¨è€…åªèƒ½å›žè¦† 1 æ¬¡**ã€ã€‚

2.  **è¨­è¨ˆè¡¨å–®å…§å®¹**ï¼š
    * **è¡¨å–®èªªæ˜Ž**ï¼šæ¸…æ¥šå¯«ä¸‹å¡«å¯«è¦å‰‡ã€æˆªæ­¢æ—¥æœŸï¼Œä¸¦**å¼·çƒˆå»ºè­°**å°‡ `å¯¦ç¿’åé¡è¡¨` çš„å…§å®¹æˆªåœ–æˆ–ä»¥æ–‡å­—æ–¹å¼è²¼åœ¨èªªæ˜Žå€ï¼Œæ–¹ä¾¿å­¸ç”ŸæŸ¥é–±ã€‚
    * **å•é¡Œä¸€ï¼šå­¸è™Ÿ** (ç°¡ç­”ã€å¿…å¡«)
    * **å•é¡ŒäºŒï¼šå§“å** (ç°¡ç­”ã€å¿…å¡«)
    * **å•é¡Œä¸‰è‡³ä¸ƒï¼šç¬¬ä¸€è‡³ç¬¬äº”å¿—é¡˜**
        * **å•é¡Œé¡žåž‹**ï¼šå‹™å¿…ä½¿ç”¨**ã€Œä¸‹æ‹‰å¼é¸å–® (Drop-down)ã€**ã€‚
        * **é¸é …å…§å®¹**ï¼šå°‡ `å¯¦ç¿’åé¡è¡¨` çš„è³‡è¨Šï¼Œçµ„åˆæˆå°ä½¿ç”¨è€…å‹å–„çš„æ ¼å¼ï¼šã€Œ`[å¿—é¡˜ä»£ç¢¼] - [æ©Ÿæ§‹åç¨±] - [æ™‚æ®µ] (è² è²¬è€å¸«)`ã€ã€‚

        **ç¯„ä¾‹é¸é …ï¼š**
        * `H01 - ç¨»é¦™æ—¥ç…§ä¸­å¿ƒ - é€±ä¸€ (9:00-12:00) (è² è²¬è€å¸«)`
        * `H02 - ç¨»é¦™æ—¥ç…§ä¸­å¿ƒ - é€±äºŒ (9:00-12:00) (è² è²¬è€å¸«)`
        * `V01 - åŒ—æ¦®é†«é™¢ - é€±äºŒ (8:00-9:50) (è² è²¬è€å¸«)`
        * ... (ä¾åºåŠ å…¥æ‰€æœ‰é¸é …) ...

3.  **é€£çµè‡³ Google Sheet**ï¼š
    * åœ¨ Google è¡¨å–®çš„ã€Œå›žæ‡‰ã€åˆ†é ï¼Œé»žæ“Šç¶ è‰²çš„ã€Œåœ¨è©¦ç®—è¡¨ä¸­æŸ¥çœ‹ã€åœ–ç¤ºã€‚
    * é¸æ“‡ã€Œ**é¸å–ç¾æœ‰è©¦ç®—è¡¨**ã€ï¼Œä¸¦æ‰¾åˆ°ä½ åœ¨ç¬¬ä¸€æ­¥å»ºç«‹çš„ã€Œå¯¦ç¿’å¿—é¡˜åˆ†é…ç¸½è¡¨ã€ã€‚
    * é€™æœƒè‡ªå‹•å°‡è¡¨å–®å›žæ‡‰é€£çµåˆ°ä½ çš„ `è¡¨å–®å›žæ‡‰` å·¥ä½œè¡¨ã€‚

### **ç¬¬ä¸‰æ­¥ï¼šå®‰è£èˆ‡åŸ·è¡Œ Apps Script**

1.  **å®‰è£è…³æœ¬**ï¼š
    * å›žåˆ°ä½ çš„ Google Sheetï¼Œé»žæ“Šä¸Šæ–¹é¸å–®çš„ `æ“´å……åŠŸèƒ½` > `Apps Script`ã€‚
    * åˆªé™¤ç·¨è¼¯å™¨ä¸­æ‰€æœ‰é è¨­å…§å®¹ï¼Œå°‡æœ¬å°ˆæ¡ˆæä¾›çš„ `main.gs` æª”æ¡ˆä¸­çš„**æ‰€æœ‰ç¨‹å¼ç¢¼**å®Œæ•´è¤‡è£½ä¸¦è²¼ä¸Šã€‚
    * é»žæ“Šä¸Šæ–¹çš„ã€ŒðŸ’¾ã€(å„²å­˜å°ˆæ¡ˆ) åœ–ç¤ºã€‚

2.  **åŸ·è¡Œåˆ†ç™¼**ï¼š
    * **é‡æ–°æ•´ç†**ä½ çš„ Google Sheet ç¶²é ã€‚
    * ä½ æœƒåœ¨é¸å–®åˆ—çœ‹åˆ°ä¸€å€‹æ–°çš„æŒ‰éˆ•ã€Œ**è‡ªå‹•åˆ†ç™¼å·¥å…·**ã€ã€‚
    * é»žæ“Šå®ƒï¼Œç„¶å¾Œé¸æ“‡ã€Œ**>> é–‹å§‹åŸ·è¡Œå¯¦ç¿’åˆ†ç™¼ (å­¸è™Ÿç‰ˆ) <<**ã€ã€‚

3.  **æŽˆæ¬Š (åƒ…é™é¦–æ¬¡åŸ·è¡Œ)**ï¼š
    * ç¬¬ä¸€æ¬¡åŸ·è¡Œæ™‚ï¼ŒGoogle æœƒè¦æ±‚ä½ æŽˆæ¬Šã€‚
    * è«‹é»žæ“Šã€Œ`å¯©æŸ¥æ¬Šé™`ã€ï¼Œé¸æ“‡ä½ çš„ Google å¸³è™Ÿã€‚
    * åœ¨ä¸‹ä¸€å€‹ã€Œä¸å®‰å…¨ã€çš„è­¦å‘Šé é¢ï¼Œé»žæ“Šã€Œ`é€²éšŽ`ã€ï¼Œç„¶å¾Œé»žæ“Šã€Œ`å‰å¾€ã€Œ(ä½ çš„å°ˆæ¡ˆåç¨±)ã€(ä¸å®‰å…¨)`ã€ï¼Œæœ€å¾Œé»žæ“Šã€Œ`å…è¨±`ã€ã€‚é€™æ˜¯ Apps Script çš„æ¨™æº–æŽˆæ¬Šæµç¨‹ï¼Œè«‹æ”¾å¿ƒæ“ä½œã€‚

4.  **æŸ¥çœ‹çµæžœ**ï¼š
    * åŸ·è¡Œå®Œç•¢å¾Œï¼Œç³»çµ±æœƒè·³å‡ºã€Œåˆ†ç™¼å®Œæˆã€çš„æç¤ºã€‚
    * è«‹å‰å¾€ `æœ€çµ‚åˆ†ç™¼çµæžœ` å·¥ä½œè¡¨ï¼Œå³å¯çœ‹åˆ°æ‰€æœ‰å­¸ç”Ÿçš„åˆ†é…çµæžœã€‚

---

## ðŸ“‚ å°ˆæ¡ˆæª”æ¡ˆçµæ§‹

* `main.gs`ï¼šåŒ…å«æ‰€æœ‰æ ¸å¿ƒæ¥­å‹™é‚è¼¯çš„ Google Apps Script ç¨‹å¼ç¢¼ã€‚
* `DataTemplate.xlsx`ï¼šä¸€å€‹ Excel ç¯„æœ¬æª”æ¡ˆï¼Œå±•ç¤ºäº† Google Sheet æ‡‰æœ‰çš„å››å€‹å·¥ä½œè¡¨çµæ§‹ã€‚
* `README.md`ï¼šæœ¬èªªæ˜Žæ–‡ä»¶ã€‚
